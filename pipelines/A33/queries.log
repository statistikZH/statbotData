[1] "Environment: REMOTE, Time: 2023-10-20 15:09:00"

Query Nr. 1
-- What were the names of the 3 most populous municipalities in canton Schwyz in 2015?
SELECT S.name FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2015 GROUP BY S.name ORDER BY SUM(T.anzahl_personen) DESC LIMIT 3;
       name
 Freienbach
 Einsiedeln
     Schwyz

Query Nr. 2
-- How many inhabitants were there in Freienbach (SZ) during the period 2010 - 2020 ?
SELECT T.jahr, SUM(T.anzahl_personen) FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND S.name IN ('Freienbach', 'Freienbach (SZ)')     AND T.jahr >= 2010     AND T.jahr <= 2020 GROUP BY T.jahr ORDER BY T.jahr ASC;
 jahr   sum
 2010 15603
 2011 15699
 2012 15750
 2013 15867
 2014 16059
 2015 15959
 2016 16040
 2017 16083
 2018 16261
 2019 16543
 2020 16603

Query Nr. 3
-- Which 5 municipalities in Canton Schwyz had the highest male/female ratio in 2010? Also report the ratio.
SELECT     S.name,     (         SUM(CASE WHEN T.geschlecht = 'männlich' THEN T.anzahl_personen ELSE 0 END) /         SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen ELSE 0 END)     ) AS weiblich_mannlich_verhaltnis_2010 FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2010 GROUP BY S.name ORDER BY weiblich_mannlich_verhaltnis_2010 DESC LIMIT 5;
       name weiblich_mannlich_verhaltnis_2010
 Vorderthal                          1.206074
 Feusisberg                          1.164390
    Alpthal                          1.136882
   Wollerau                          1.132597
 Freienbach                          1.126039

Query Nr. 4
-- What is the percentage of municipalities in Schwyz that had more than 10000 inhabitants in 2020?
SELECT     (         100.0 *         COUNT(CASE WHEN T1.tot_personen > 10000 THEN 1 END) /         COUNT(*)     )AS prozent_gemeinden_mehr_als_10000_einwohner_2020 FROM (     SELECT SUM(T.anzahl_personen) as tot_personen     FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T     JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid     WHERE S.municipal = TRUE         AND T.jahr = 2020     GROUP BY S.name ) as T1;
 prozent_gemeinden_mehr_als_10000_einwohner_2020
                                        14.28571

Query Nr. 5
-- What were the 10 municipalities in Schwyz with the lowest population growth between 2005 and 2022, and what was their percentage growth ?
SELECT     S.name,     (         100.0 *         SUM(CASE WHEN T.jahr = 2022 THEN T.anzahl_personen ELSE -T.anzahl_personen END) /         SUM(CASE WHEN T.jahr = 2005 THEN T.anzahl_personen ELSE 0 END)     ) AS prozent_wachstum FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr IN (2005, 2022) GROUP BY S.name ORDER BY prozent_wachstum ASC LIMIT 10;
          name prozent_wachstum
    Vorderthal        -2.694611
     Muotathal        -1.467683
     Innerthal         1.714286
        Illgau         3.865979
    Unteriberg         6.116208
   Steinerberg         6.629213
        Schwyz         8.900853
      Wollerau        10.430171
     Oberiberg        10.765240
 Riemenstalden        12.000000

Query Nr. 6
-- Show me the number of foreign and Swiss residents for the 5 most populous municipalities in Schwyz in 2015.
SELECT     S.name,     SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS schweizer,     SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS auslander FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2015 GROUP BY S.name ORDER BY SUM(T.anzahl_personen) DESC LIMIT 5;
        name schweizer auslander
  Freienbach     11685      4274
  Einsiedeln     12833      2171
      Schwyz     12292      2458
        Arth      8484      3008
 Schübelbach      6498      2412

Query Nr. 7
-- What was the proportion of men among swiss and foreign residents in canton Schwyz each year between 2015 and 2020?
SELECT     T.jahr,     (         SUM(CASE WHEN T.geschlecht = 'männlich' AND T.nationalitaet = 'Schweiz' THEN T.anzahl_personen END) /         SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen END)     ) AS anteil_manner_schweizer,     (         SUM(CASE WHEN T.geschlecht = 'männlich' AND T.nationalitaet = 'Ausland' THEN T.anzahl_personen END) /         SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen END)     ) AS anteil_manner_auslander FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr >= 2015     AND T.jahr >= 2020 GROUP BY T.jahr ORDER BY T.jahr ASC;
 jahr anteil_manner_schweizer anteil_manner_auslander
 2020               0.5051499               0.5378367
 2021               0.5057816               0.5401439
 2022               0.5054410               0.5418194

Query Nr. 8
-- What was the year-on-year growth rate of the population in canton Schwyz each year during the preiod 2005-2010?
WITH T1 AS (     SELECT         T.jahr,         SUM(T.anzahl_personen) AS tot_personen     FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T     JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid     WHERE S.municipal = TRUE         AND T.jahr >= 2005         AND T.jahr <= 2010     GROUP BY T.jahr     ORDER BY T.jahr ASC ) SELECT     T1.jahr,     (         100.0 *         (T1.tot_personen - LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)) /         LAG(T1.tot_personen) OVER (ORDER BY T1.jahr ASC)     ) AS tot_personen_vorjahr FROM T1;
 jahr tot_personen_vorjahr
 2005                   NA
 2006            1.2635304
 2007            1.4037351
 2008           -2.5052747
 2009            0.6880488
 2010            1.6054143

Query Nr. 9
-- Show me the number of men and women in canton Schwyz in 2005, 2010, 2015 and 2020.
SELECT     T.jahr,     SUM(CASE WHEN T.geschlecht = 'männlich' THEN T.anzahl_personen END) AS anzahl_manner,     SUM(CASE WHEN T.geschlecht = 'weiblich' THEN T.anzahl_personen END) AS anzahl_frauen FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr IN (2005, 2010, 2015, 2020) GROUP BY T.jahr ORDER BY T.jahr ASC;
 jahr anzahl_manner anzahl_frauen
 2005         61144         59787
 2010         60447         63410
 2015         69457         66337
 2020         73055         69550

Query Nr. 10
-- What was the swiss and foreign population in the 3 smallest Schwyz municipalities in 2020?
SELECT     S.name,     SUM(CASE WHEN T.nationalitaet = 'Schweiz' THEN T.anzahl_personen ELSE 0 END) AS anzahl_schweizer,     SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) AS anzahl_auslander FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2020 GROUP BY S.name ORDER BY SUM(T.anzahl_personen) ASC LIMIT 3;
          name anzahl_schweizer anzahl_auslander
 Riemenstalden               82                4
     Innerthal              168               10
       Alpthal              552               55

Query Nr. 11
-- Show me the proportion of foreigners (foreigners/total) in canton Schwyz in each year between 2010 and 2020.
SELECT     T.jahr,     (         SUM(CASE WHEN T.nationalitaet = 'Ausland' THEN T.anzahl_personen ELSE 0 END) /         SUM(T.anzahl_personen)     ) AS anteil_auslander FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr >= 2010     AND T.jahr <= 2020 GROUP BY T.jahr ORDER BY T.jahr ASC;
 jahr anteil_auslander
 2010        0.1921732
 2011        0.1864185
 2012        0.1906186
 2013        0.1941244
 2014        0.1977277
 2015        0.1979101
 2016        0.2009903
 2017        0.2044319
 2018        0.2104759
 2019        0.2156115
 2020        0.2184145

Query Nr. 12
-- For each year in the period 2018 - 2021, show me the number of swiss residents in Einsiedeln, SZ.
SELECT T.jahr, SUM(T.anzahl_personen) AS anzahl_schweizer_2021_einsiedeln FROM schwyz_standige_wohnbevolkerung_geschlecht_nationalitat AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr >= 2018     AND T.jahr <= 2021     AND S.name IN ('Einsiedeln', 'Einsiedeln (SZ)')     AND T.nationalitaet = 'Schweiz' GROUP BY T.jahr ORDER BY T.jahr ASC;
 jahr anzahl_schweizer_2021_einsiedeln
 2018                            13308
 2019                            13441
 2020                            13522
 2021                            13484
