[1] "Environment: LOCAL, Time: 2023-10-06 13:53:04"

Query Nr. 1
-- What was the break down of renewable energy production in canton Thurgau each year since 2018?
SELECT     T.jahr,     SUM(biogasanlagen_abwasser_gwh),     SUM(biogasanlagen_industrie_gwh),     SUM(biogasanlagen_landwirtschaft_gwh),     SUM(biomasse_holz_gwh),     SUM(kehricht_gwh),     SUM(photovoltaik_gwh),     SUM(wasserkraft_gwh),     SUM(wind_gwh),     SUM(total_gwh) FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr >= 2018 GROUP BY T.jahr;
 jahr SUM(biogasanlagen_abwasser_gwh) SUM(biogasanlagen_industrie_gwh)
 2018                           7.045                         1.826000
 2019                           6.485                         1.326000
 2020                           7.458                         1.819000
 2021                           7.440                         0.651573
 SUM(biogasanlagen_landwirtschaft_gwh) SUM(biomasse_holz_gwh) SUM(kehricht_gwh)
                                 7.983                  3.072          45.76800
                                 9.791                  2.552          55.34500
                                12.213                  2.570          57.31700
                                12.333                  3.270          49.98273
 SUM(photovoltaik_gwh) SUM(wasserkraft_gwh) SUM(wind_gwh) SUM(total_gwh)
               113.017               32.147         0.004       210.8620
               126.267               46.327         0.006       248.0990
               146.075               40.544         0.005       268.0010
               170.916               48.561         0.005       293.1593

Query Nr. 2
-- What percentage of the renewable energy in Frauenfeld, TG was produced by solar energy in 2021?
SELECT     100 * photovoltaik_gwh/total_gwh AS photovoltaik_prozent_frauenfeld_2021 FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2021     AND S.name LIKE 'Frauenfeld%';
 photovoltaik_prozent_frauenfeld_2021
                             71.48511

Query Nr. 3
-- How many municipalities in canton Thurgau were producing energy from wind in 2019?
SELECT     COUNT(*) FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2019     AND T.wind_gwh > 0;
 COUNT(*)
        1

Query Nr. 4
-- What is the municipality in canton Thurgau that produced the most renewable energy relative to its population in 2020?
SELECT S.name FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2020 ORDER BY T.total_gwh / T.einwohner DESC LIMIT 1;
       name
 Weinfelden

Query Nr. 5
-- What is the proportion (in percent) of municipalities in Thurgau which did not produce any renewable energy in 2017?
SELECT 100 * SUM(CASE WHEN T.total_gwh = 0 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_kein_erneurerbare_energie_2017 FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2017;
 prozent_kein_erneurerbare_energie_2017
                                      0

Query Nr. 6
-- How much renewable energy is produced by the top 5 largest municipalities in Thurgau in 2021?
SELECT S.name, T.total_gwh FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2021 ORDER BY T.einwohner DESC LIMIT 5;
        name total_gwh
  Frauenfeld  15.95157
 Kreuzlingen   5.41300
       Arbon   4.16600
    Amriswil   5.43100
  Weinfelden  68.98073

Query Nr. 7
-- What 3 municipalities in Thurgau showed the largest increase in renewable energy production between 2018 and 2021? Also show the percentage increase.
SELECT     S.name,     (         100.0 * SUM( CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) /         SUM( CASE WHEN T.jahr = 2018 THEN T.total_gwh ELSE 0 END     )) AS prozent_anstieg FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr IN (2018, 2021) GROUP BY S.name ORDER BY prozent_anstieg DESC LIMIT 3;
              name prozent_anstieg
         Stettfurt        425.8278
            Egnach        403.3990
 Felben-Wellhausen        264.3154

Query Nr. 8
-- In total, how many MWh of renewable energy did Amriswil, in Kanton Thurgau, produce from 2016 to 2020?
SELECT SUM(T.total_gwh) * 1000 AS total_mwh FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND S.name LIKE "Amriswil%"     AND T.jahr >= 2016     AND T.jahr <= 2020;
 total_mwh
     19962

Query Nr. 9
-- Show me 2 municipalities in Aargau which were the most important producer of energy from wood biomass in 2019.
SELECT S.name FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2019 ORDER BY T.biomasse_holz_gwh DESC LIMIT 2;
                 name
 Bichelsee-Balterswil
            Eschlikon

Query Nr. 10
-- What is the total amount of renewable energy produced from waste incineration in canton Thurgau in 2020?
SELECT S.name FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2019 ORDER BY T.biomasse_holz_gwh DESC LIMIT 2;
                 name
 Bichelsee-Balterswil
            Eschlikon

Query Nr. 11
-- How many GWh of energy were produced from each type of biogas plant in canton Thurgau in 2015?
SELECT SUM(biogasanlagen_abwasser_gwh), SUM(biogasanlagen_industrie_gwh), SUM(biogasanlagen_landwirtschaft_gwh) FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2015;
 SUM(biogasanlagen_abwasser_gwh) SUM(biogasanlagen_industrie_gwh)
                           4.816                             2.27
 SUM(biogasanlagen_landwirtschaft_gwh)
                                 3.656

Query Nr. 12
-- What was the smallest municipality (in inhabitants) to produce energy from waste incineration in canton Thurgau in 2021?
SELECT S.name FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2021     AND T.kehricht_gwh > 0 ORDER BY T.einwohner ASC LIMIT 1;
       name
 Weinfelden

Query Nr. 13
-- Show me the production of energy from sun and wind in Berg, TG in 2018.
SELECT T.photovoltaik_gwh, T.wind_gwh FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND S.name LIKE 'Berg%'     AND T.jahr = 2018;
 photovoltaik_gwh wind_gwh
            1.995    0.004

Query Nr. 14
-- Which 3 municipalities in Thurgau had the highest share of hydroenergy in their total renewable energy production in 2019, and how high was it?
SELECT     S.name,     100.0 * T.wasserkraft_gwh / T.total_gwh AS prozent_wasserkraft FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2019 ORDER BY prozent_wasserkraft DESC LIMIT 3;
                name prozent_wasserkraft
 Kradolf-Schönenberg            93.36694
        Bürglen (TG)            90.81354
                Pfyn            73.88193

Query Nr. 15
-- What proportion of municipalities in canton Thurgau had a decrease in renewable energy production between 2015 and 2021?
SELECT 100 * SUM(CASE WHEN T.total_gwh_2015 > T.total_gwh_2021 THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT) AS prozent_abnahme FROM (     SELECT         S.name,         SUM(CASE WHEN T.jahr = 2015 THEN T.total_gwh ELSE 0 END) AS total_gwh_2015,         SUM(CASE WHEN T.jahr = 2021 THEN T.total_gwh ELSE 0 END) AS total_gwh_2021     FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T     JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid     WHERE S.municipal = TRUE         AND T.jahr IN (2015, 2021)     GROUP BY S.name ) AS T;
 prozent_abnahme
            1.25

Query Nr. 16
-- Show me the production of energy from agricultural biogas in Fischingen, canton Thurgau, in 2018.
SELECT T.biogasanlagen_landwirtschaft_gwh FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE T.jahr = 2018     AND S.name LIKE 'Fischingen%';
 biogasanlagen_landwirtschaft_gwh
                             0.29

Query Nr. 17
-- How much renewable energy did canton Thurgau produce in total over the period 2017-2021?
SELECT SUM(T.total_gwh) AS total_gwh FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T WHERE T.jahr >= 2017     AND T.jahr <= 2021;
 total_gwh
  1222.244

Query Nr. 18
-- What was the production of solar energy from Roggwil and Langrickenbach, TG in 2019 and 2020?
SELECT S.name, T.jahr, T.photovoltaik_gwh FROM thurgau_erneuerbare_elektrizitatsproduktion_gemeinde AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE (S.name LIKE 'Roggwil%' OR S.name LIKE 'Langrickenbach%')     AND T.jahr IN (2019, 2020) ORDER BY S.name, T.jahr;
           name jahr photovoltaik_gwh
 Langrickenbach 2019            0.809
 Langrickenbach 2020            1.008
   Roggwil (TG) 2019            2.575
   Roggwil (TG) 2020            3.042
