
Query Nr. 1
-- What farm animals were bred in the canton of Bern in 2020?
SELECT livestock_beef_cattle_and_cows, livestock_sheep, livestock_goats, livestock_pigs, livestock_poultry, livestock_other_animals FROM employees_farmholdings_agricultural_area_livestock_per_canton as T JOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid WHERE S.name="Canton of Bern"     AND S.canton=TRUE     AND T.year=2020     AND T.farmholding_system == "Farmholding system - total";
=======================================================
# A tibble: 1 × 6
  livestock_beef_cattle_and_cows livestock_sheep livestock_goats livestock_pigs
                           <dbl>           <dbl>           <dbl>          <dbl>
1                              0            1530             747              0
# ℹ 2 more variables: livestock_poultry <dbl>, livestock_other_animals <dbl>

Query Nr. 2
-- How many farms were there in all of Switzerland between 2012 and 2018?
SELECT year, farmholding_system, farmholdings FROM employees_farmholdings_agricultural_area_livestock_per_canton as T JOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid WHERE S.name="Switzerland"     AND S.country=TRUE     AND year BETWEEN 2012 AND 2018     AND T.farmholding_system == "Farmholding system - total";
=======================================================
# A tibble: 7 × 3
   year farmholding_system         farmholdings
  <dbl> <chr>                             <dbl>
1  2018 Farmholding system - total        50852
2  2017 Farmholding system - total        51620
3  2016 Farmholding system - total        52263
4  2015 Farmholding system - total        53253
5  2014 Farmholding system - total        54057
6  2013 Farmholding system - total        55207
7  2012 Farmholding system - total        56575

Query Nr. 3
-- What was the total agricultural surface area in the canton of Geneva in 2000?
SELECT utilised_agricultural_area_in_hectares as utilised_agricultural_area_in_hectares_canton_geneva FROM employees_farmholdings_agricultural_area_livestock_per_canton as T JOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid WHERE S.name="Canton Geneva"     AND S.canton=TRUE     AND year=2000     AND T.farmholding_system == "Farmholding system - total";
=======================================================
# A tibble: 1 × 1
  utilised_agricultural_area_in_hectares_canton_geneva
                                                 <dbl>
1                                                  808

Query Nr. 4
-- What were the 5 cantons farming the most pigs in 2012?
SELECT S.name as canton_name, livestock_pigs as total_pigs FROM employees_farmholdings_agricultural_area_livestock_per_canton as T JOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid WHERE S.canton=TRUE     AND year=2012     AND T.farmholding_system == "Farmholding system - total" ORDER BY livestock_pigs DESC LIMIT 5;
=======================================================
# A tibble: 5 × 2
  canton_name          total_pigs
  <chr>                     <dbl>
1 Canton of Zug              5239
2 Canton Ticino              2282
3 Canton of St. Gallen       1056
4 Canton of Zurich            857
5 Canton of Lucerne           847

Query Nr. 5
-- What was the average number of cows per farm in the canton of Vaud since 2017?
SELECT livestock_beef_cattle_and_cows / farmholdings AS average_cows_per_farmholding_vaud FROM employees_farmholdings_agricultural_area_livestock_per_canton as T JOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid WHERE S.name="Canton Vaud"     AND S.canton=TRUE     AND year >= 2017     AND T.farmholding_system == "Farmholding system - total";
=======================================================
# A tibble: 6 × 1
  average_cows_per_farmholding_vaud
                              <dbl>
1                                 0
2                                 0
3                                 0
4                                 0
5                                 0
6                                 0

Query Nr. 6
-- What canton has the highest percentage of organic farms most recently?
SELECT     year,     S.name AS canton_name,     (         SUM(             CASE WHEN farmholding_system = 'Organic farming'             THEN farmholdings             ELSE 0 END         ) * 100.0 /         SUM(             CASE WHEN farmholding_system = 'Farmholding system - total'             THEN farmholdings             ELSE 0 END         )     ) AS percentage_organic_farms FROM employees_farmholdings_agricultural_area_livestock_per_canton as T JOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid WHERE year = (     SELECT MAX(year)     FROM employees_farmholdings_agricultural_area_livestock_per_canton ) GROUP BY year, S.name ORDER BY percentage_organic_farms LIMIT 1;
=======================================================
# A tibble: 1 × 3
   year canton_name   percentage_organic_farms
  <dbl> <chr>         <lgl>
1  2022 Canton Geneva NA

Query Nr. 7
-- Does the average organic farm have less employees than the average non-organic farm in 2022?
SELECT farmholding_system, employees_total, farmholdings, employees_total / farmholdings AS average_employees_per_farm FROM employees_farmholdings_agricultural_area_livestock_per_canton as T JOIN spatial_unit as S on T.spatialunit_uid = S.spatialunit_uid WHERE T.year=2022     AND S.name="Switzerland"     AND S.country=TRUE     AND T.farmholding_system IN ("Organic farming", "Conventional farming");
=======================================================
# A tibble: 2 × 4
  farmholding_system   employees_total farmholdings average_employees_per_farm
  <chr>                          <dbl>        <dbl>                      <dbl>
1 Organic farming                  870         1710                      0.509
2 Conventional farming              17           19                      0.895
