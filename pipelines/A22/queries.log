
Query Nr. 1
-- How many protestants were there in kanton Basel-Landschaft in early 2022?
SELECT SUM(T.anzahl_evangelisch_reformiert) FROM bevolkerungsbestand_nach_nationalitat_konfession_gemeinde_und_quartal_seit_2003 as T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal=TRUE     AND T.jahr="2022"     AND T.quartal="1";
 SUM(T.anzahl_evangelisch_reformiert)
                                79078

Query Nr. 2
-- What proportion of Basel-Landschaft's population were of a known religion in 2021?
SELECT 1 - (     SUM(CAST(T.anzahl_unbekannt_konfession AS FLOAT)) / SUM(T.gesamt_anzahl_personen) ) AS proportion_known_religion_basel_land_2021 FROM bevolkerungsbestand_nach_nationalitat_konfession_gemeinde_und_quartal_seit_2003 as T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal=TRUE     AND T.jahr="2021" GROUP BY T.jahr;
 proportion_known_religion_basel_land_2021
                                 0.5078361

Query Nr. 3
-- In 2021, among the foreign residents of Canton Basel-Landschaft, what was the proportion of Roman catholics?
SELECT SUM(CAST(T.anzahl_romisch_katholisch AS FLOAT)) / SUM(T.gesamt_anzahl_personen) AS proportion_foreign_romisch_katholisch_basel_land_2021 FROM bevolkerungsbestand_nach_nationalitat_konfession_gemeinde_und_quartal_seit_2003 as T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal=TRUE     AND T.jahr="2021"     AND T.nationalitat="Ausland";
 proportion_foreign_romisch_katholisch_basel_land_2021
                                             0.2271123

Query Nr. 4
-- What were the 5 municipalities with the highest proportion of protestants in Basel-Landschaft in 2008?
SELECT S.name, CAST(SUM(T.anzahl_evangelisch_reformiert) AS FLOAT) / SUM(T.gesamt_anzahl_personen) as proportion_protestants_2008 FROM bevolkerungsbestand_nach_nationalitat_konfession_gemeinde_und_quartal_seit_2003 as T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal=TRUE     AND T.jahr="2008" GROUP BY S.name ORDER BY proportion_protestants_2008 DESC LIMIT 5;
           name proportion_protestants_2008
 Kilchberg (BL)                   0.8219697
      Zeglingen                   0.7673536
    Wittinsburg                   0.7577938
     Rothenfluh                   0.7401762
       Oltingen                   0.7345133

Query Nr. 5
-- What was the proportion of municipalities in Basel-Landschaft where there were more catholics than reformed among Swiss residents in 2018?
SELECT SUM(     (anzahl_romisch_katholisch + anzahl_christkatholisch) > anzahl_evangelisch_reformiert ) / CAST(COUNT(anzahl_evangelisch_reformiert) AS FLOAT) AS proprtion_municipalities_more_catholics_than_reformed_2018 FROM (     SELECT         S.name as municipality,         AVG(T.anzahl_christkatholisch) as anzahl_christkatholisch,         AVG(T.anzahl_romisch_katholisch) as anzahl_romisch_katholisch,         AVG(T.anzahl_evangelisch_reformiert) as anzahl_evangelisch_reformiert     FROM bevolkerungsbestand_nach_nationalitat_konfession_gemeinde_und_quartal_seit_2003 as T     JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid     WHERE S.municipal=TRUE         AND T.jahr="2018"         AND T.nationalitat="Schweiz"     GROUP BY S.name );
 proprtion_municipalities_more_catholics_than_reformed_2018
                                                  0.2093023
