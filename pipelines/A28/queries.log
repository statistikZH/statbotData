[1] "Environment: REMOTE, Time: 2023-10-23 20:53:08"

Query Nr. 1
-- Wie viele Personen waren 2015 im primären Sektor in Uttwil TG beschäftigt?
SELECT T.beschaftigte_personen FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND S.name IN ('Uttwil', 'Uttwil (TG)')     AND T.jahr = 2015     AND T.sektor = 'Primär';
 beschaftigte_personen
                    50

Query Nr. 2
-- Wie viele Beschäftigte des tertiären Sektors waren 2011 und 2021 im Kanton Thurgau tätig?
SELECT T.jahr, SUM(T.beschaftigte_personen) FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal=TRUE     AND T.jahr IN (2011, 2021)     AND T.sektor = 'Tertiär' GROUP BY T.jahr;
 jahr   sum
 2011 77872
 2021 94153

Query Nr. 3
-- Welches sind die fünf Thurgauer Gemeinden mit dem höchsten Anteil an Beschäftigten im sekundären Sektor im Jahr 2020? Geben Sie auch die Anteile in Prozent an.
SELECT     S.name AS gemeinde,     (         100.0 * SUM(CASE WHEN T.sektor = 'Sekundär' THEN T.beschaftigte_personen ELSE 0 END) /         SUM(T.beschaftigte_personen)     ) as prozent_beschaftigte_personen_sektor_2 FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2020 GROUP BY S.name ORDER BY prozent_beschaftigte_personen_sektor_2 DESC LIMIT 5;
          gemeinde prozent_beschaftigte_personen_sektor_2
          Bussnang                               73.63384
        Hefenhofen                               67.78917
            Sulgen                               57.76614
      Affeltrangen                               54.12044
 Felben-Wellhausen                               50.62762

Query Nr. 4
-- Wie viele Personen waren im Jahr 2015 in der Stadt Frauenfeld im Kanton Thurgau im sekundären Sektor beschäftigt?
SELECT T.beschaftigte_personen FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND S.name IN ('Frauenfeld', 'Frauenfeld (TG)')     AND T.jahr = 2015     AND T.sektor = 'Sekundär';
 beschaftigte_personen
                  4551

Query Nr. 5
-- Wie hoch war die Zahl der Beschäftigten pro Wirtschaftszweig im Kanton Thurgau in den Jahren 2017 bis 2020?
SELECT T.jahr, T.sektor, SUM(T.beschaftigte_personen) FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr >= 2017     AND T.jahr <= 2020 GROUP BY T.sektor, T.jahr;
 jahr   sektor   sum
 2017 Sekundär 41204
 2018  Tertiär 87516
 2019 Sekundär 41731
 2017  Tertiär 86257
 2018 Sekundär 41545
 2020  Tertiär 91116
 2017   Primär  8666
 2018   Primär  8635
 2019   Primär  8648
 2020 Sekundär 40979
 2019  Tertiär 90049
 2020   Primär  8640

Query Nr. 6
-- In welcher Thurgauer Gemeinde ist die Zahl der Beschäftigten zwischen 2015 und 2020 am stärksten gewachsen?
SELECT S.name AS gemeinde FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr IN (2015, 2020) GROUP BY S.name ORDER BY (     100.0 * SUM(CASE WHEN T.jahr = 2020 THEN T.beschaftigte_personen ELSE 0 END) /     SUM(CASE WHEN T.jahr = 2015 THEN T.beschaftigte_personen ELSE 0 END) ) DESC LIMIT 1;
 gemeinde
 Bussnang

Query Nr. 7
-- Wie hoch ist die relative Veränderung der Beschäftigten in den einzelnen Wirtschaftssektoren im Thurgau in Prozent zwischen 2011 und 2021?
SELECT     AGG.sektor,     (         100.0 *         (AGG.beschaftigte_personen_2021 - AGG.beschaftigte_personen_2011) /         AGG.beschaftigte_personen_2011     ) AS relative_veranderung_beschaftigte_personen FROM (     SELECT         T.sektor,         SUM(CASE WHEN T.jahr = 2021 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_2021,         SUM(CASE WHEN T.jahr = 2011 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_2011     FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T     JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid     WHERE S.municipal = TRUE         AND T.jahr IN (2011, 2021)     GROUP BY T.sektor ) AS AGG;
   sektor relative_veranderung_beschaftigte_personen
   Primär                                  -2.847405
 Sekundär                                   1.469652
  Tertiär                                  20.907386

Query Nr. 8
-- In welchem Jahr erreichte die Zahl der Beschäftigten im primären Sektor im Thurgau ihren Höhepunkt?
SELECT T.jahr FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.sektor = 'Primär' GROUP BY T.jahr ORDER BY SUM(T.beschaftigte_personen) DESC LIMIT 1;
 jahr
 2011

Query Nr. 9
-- Wie hoch ist der Anteil (in %) der Thurgauer Gemeinden, in denen 2016 die Zahl der Beschäftigten im primären Sektor höher war als im sekundären Sektor?
SELECT (     100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1 > T.beschaftigte_personen_sektor_2 THEN 1 END) /     COUNT(*) ) AS prozent_gemeinden_hohere_sektor_1 FROM (     SELECT         S.name AS gemeinde,         SUM(CASE WHEN T.sektor = 'Primär' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1,         SUM(CASE WHEN T.sektor = 'Sekundär' THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_2     FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T     JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid     WHERE S.municipal = TRUE         AND T.jahr = 2016     GROUP BY S.name ) AS T;
 prozent_gemeinden_hohere_sektor_1
                             21.25

Query Nr. 10
-- Wie hoch ist der Anteil der Thurgauer Gemeinden, in denen die Zahl der Beschäftigten im primären Sektor zwischen 2013 und 2018 abgenommen hat?
SELECT (     100.0 * COUNT(CASE WHEN T.beschaftigte_personen_sektor_1_2018 < T.beschaftigte_personen_sektor_1_2013 THEN 1 END) /     COUNT(*) ) AS prozent_gemeinden_abnahme_sektor_1 FROM (     SELECT         S.name AS gemeinde,         SUM(CASE WHEN T.jahr = 2013 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2013,         SUM(CASE WHEN T.jahr = 2018 THEN T.beschaftigte_personen ELSE 0 END) AS beschaftigte_personen_sektor_1_2018     FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T     JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid     WHERE S.municipal = TRUE         AND T.jahr IN (2013, 2018)         AND T.sektor = 'Primär'     GROUP BY S.name ) AS T;
 prozent_gemeinden_abnahme_sektor_1
                                 60

Query Nr. 11
-- Welche Thurgauer Gemeinde hatte im Jahr 2020 die wenigsten Beschäftigten?
SELECT S.name AS gemeinde FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND T.jahr = 2020 GROUP BY S.name ORDER BY SUM(T.beschaftigte_personen) ASC LIMIT 1;
   gemeinde
 Gottlieben

Query Nr. 12
-- Wie viele Beschäftigte aus dem ersten Sektor gab es in Arbon und Egnach, Thurgau, in den Jahren 2012 und 2019?
SELECT S.name AS gemeinde, T.jahr, SUM(T.beschaftigte_personen) AS beschaftigte_personen_sektor_1 FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.municipal = TRUE     AND S.name IN ('Arbon', 'Arbon (TG)', 'Egnach', 'Egnach (TG)')     AND T.jahr IN (2012, 2019)     AND T.sektor = 'Primär' GROUP BY T.jahr, S.name ORDER BY S.name, T.jahr;
 gemeinde jahr beschaftigte_personen_sektor_1
    Arbon 2012                             37
    Arbon 2019                             37
   Egnach 2012                            383
   Egnach 2019                            396

Query Nr. 13
-- Wie viele Beschäftigte hatte die Stadt Frauenfeld TG im tertiären Sektor bisher maximal und wann?
SELECT T.jahr, T.beschaftigte_personen AS beschaftigte_personen_sektor_3 FROM thurgau_beschaftigte_nach_sektoren_und_gemeinden AS T JOIN spatial_unit AS S ON T.spatialunit_uid = S.spatialunit_uid WHERE S.name IN ('Frauenfeld', 'Frauenfeld (TG)')     AND T.sektor = 'Tertiär' ORDER BY T.beschaftigte_personen DESC LIMIT 1;
 jahr beschaftigte_personen_sektor_3
 2021                          17460
